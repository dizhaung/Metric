<script src="${rc.contextPath}/_resources/js/plugins/layer/laydate/laydate.js"></script>
<link href="${rc.contextPath}/_resources/css/bootstrap-select.css" rel="stylesheet">
<script src="${rc.contextPath}/_resources/js/bootstrap-select.js"></script>
<div class="ibox-content">
   <form class="form-horizontal" id="form1">
       <div class="form-group">
             <label class="col-sm-3 control-label">Banner名称：</label>
             <div class="col-sm-8">
                 <input type="hidden" name="bannerId" value="$!{entity.bannerId}">
                 <input type="text" class="form-control" name="name" value="$!{entity.name}" style="width:400px">
             </div>
         </div>
         <div class="form-group">
            <label class="col-sm-3 control-label">显示位置：</label>
            <div class="col-sm-8">
               <select  style="width:400px;height:30px" name="position">
                   #foreach($item in $!{positionType.entrySet()})
                     <option value="$!{item.key}" #if($!{entity.position} == $!{item.key}) selected="selected" #end>$!{item.value}</option>
                   #end
               </select>
            </div>
        </div>
        <div class="form-group">
           <label class="col-sm-3 control-label">有效期：</label>
           <div class="col-sm-8">
              <input class="form-control layer-date" name="validAtStr" value="$!{entity.validAtStr}" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
           </div>
        </div>
        <div class="form-group">
           <label class="col-sm-3 control-label">可见渠道类型：</label>
           <div class="col-sm-8 checkbox i-checks">
            #foreach($item in $!{entity.channelTypeList})
               <label class="checkbox-inline i-checks">
                   <input type="checkbox" name="channelTypeIds" value="$!{item.typeId}" lay-skin="primary" #if($!{item.checked} == '1') checked #end>$!{item.name}</label>
            #end
           </div>
        </div>
        <div class="form-group">
           <label class="col-sm-3 control-label">Banner图片：</label>
           <div class="col-sm-8">
             <input type="hidden" id="img" name="img" value="$!{entity.img}">
              #if(!${entity.img} || $!{entity.img} == '')
                 <img src="" id="imgDiv"  style="display:none" />
               #else
                 <img src="$!{ossDomain}/$!{entity.img}" id="imgDiv"/>
               #end
             <input id="file1" type="file" name="file" accept="image/*">
           </div>
        </div>
        <div class="form-group">
             <label class="col-sm-3 control-label">跳转Url：</label>
             <div class="col-sm-8">
                 <input type="text" class="form-control" name="jumpUrl" value="$!{entity.jumpUrl}" style="width:400px">
             </div>
        </div>
        <div class="form-group">
             <label class="col-sm-3 control-label">排序号：</label>
             <div class="col-sm-8">
                 <input type="text" class="form-control" name="orderNo" value="$!{entity.orderNo}" style="width:400px">
             </div>
        </div>
        <div class="form-group">
              <label class="col-sm-3 control-label">状态：</label>
              <div class="col-sm-8">
                  <select  style="width:400px;height:30px" name="status">
                       <option value="1" #if($!entity.status == 1) selected="selected" #end>启用</option>
                       <option value="0" #if($!entity.status == 0) selected="selected" #end>禁用</option>
                  </select>
              </div>
         </div>
        <div align="center">
           <button class="btn btn-success" type="button" onclick="saveBanner()"><i class="glyphicon glyphicon-ok"></i>保存</button>
           <button class="btn btn-white" type="button" onclick="parent.closeLayer()"><i class="glyphicon glyphicon-remove"></i>返回</button>
        </div>
     </form>
 </div>
 <script>
 $(document).ready(function() {
     $('.i-checks').iCheck({
         checkboxClass: 'icheckbox_square-green',
         radioClass: 'iradio_square-green',
     });
   });
  function saveBanner(){
     $.ajax({
        type: "POST",
        url:"updateBanner.html",
        dataType:"json",
        data:$('#form1').serialize(),
        success: function(data) {
           if(data.code == 1){
               parent.searchList();
               parent.closeLayer(data.msg);
            }else{
              parent.layer.msg(data.msg,failIcon);
            }
        }
    });
  }

   layui.use('upload', function(){
        layui.upload({
           url: '${rc.contextPath}/upload/uploadFile.html?uploadPath=banner/img',
           elem: '#file1',
           method: 'post',
           unwrap:true,
           success: function(res){
             if(res.code == 1){
                $("#img").val(res.data.id);
                $("#imgDiv").attr('src',res.data.value);
                $("#imgDiv").show();
             }else{
               parent.layer.msg(data.msg,failIcon);
             }
           }
        });
        $("#layui-upload-iframe").hide();
    });
</script>
</html>
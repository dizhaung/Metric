<link href="${rc.contextPath}/_resources/css/bootstrap-select.css" rel="stylesheet">
<link rel="shortcut icon" href="favicon.ico">
<link href="${rc.contextPath}/_resources/okr/static/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
<link href="${rc.contextPath}/_resources/okr/static/css/font-awesome.css?v=4.4.0" rel="stylesheet">
<link href="${rc.contextPath}/_resources/okr/static/libs/plugins/select2/select2.min.css?v=4.0.3" rel="stylesheet">
<link href="${rc.contextPath}/_resources/okr/static/css/animate.css" rel="stylesheet">
<link href="${rc.contextPath}/_resources/okr/static/css/style.css?v=4.1.0" rel="stylesheet">
<link href="${rc.contextPath}/_resources/okr/static/css/datacenter.min.css?v=1.0.0" rel="stylesheet">
<!--container start-->
<div class="composite">
    <div class="ibox float-e-margins">
        <div class="ibox-title">
            <h5>1.复合指标信息</h5>
        </div>
        <div class="compo-intro">
            <div class="col-md-12">
                <div class="col-md-4">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">指标名称：</label>
                        <div class="col-sm-8">
                            <input type="text" id="J_accName" value="$!{quota.quotaName}" class="form-control" placeholder="请输入指标名称">
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">展示类型：</label>
                        <div class="col-sm-8">
                            <select class="form-control" id="J_showType">
                                <option value="">请选择展示类型</option>
                                <option #if($!quota.showType == 'NUM') selected  #end value="NUM">数量</option>
                                <option #if($!quota.showType == 'MONEY') selected #end  value="MONEY">金额</option>
                                <option #if($!quota.showType == 'PERCENT') selected  #end  value="PERCENT">比例</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">取值方式：</label>
                        <div class="col-sm-8">
                            <select class="form-control" id="J_valType">
                                <option  value="">请选择取值方式</option>
                                <option  #if($!quota.showOperation == 'SUM') selected  #end value="SUM">合计</option>
                                <option  #if($!quota.showOperation == 'AVG') selected  #end value="AVG">平均值</option>
                                <option  #if($!quota.showOperation == 'MAX') selected  #end value="MAX">最大值</option>
                                <option  #if($!quota.showOperation == 'MIN') selected  #end value="MIN">最小值</option>
                                <option  #if($!quota.showOperation == 'COUNT') selected  #end value="COUNT">计数</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="ibox float-e-margins">
        <div class="ibox-title">
            <h5>2.配置计算公式</h5>
        </div>
        <div class="compo-intro">
            <div class="col-md-12">
                <div class="col-md-6">
                    <div class="ibox float-e-margins">
                        <div class="ibox-content">
                            <div>公式：<span class="c-val">$!{quota.expression}</span></div>
                            <input type="hidden" id="J_formulaVal" value="$!{quota.quotaSource}"/>
                            <input type="hidden" id="J_particleSize" data-psize=""  value="$!{quota.particleSize}"/>
                            <input type="hidden" id="J_formQuotaId" value="$!{quota.quotaId}"/>
                        </div>
                    </div>
                    <div class="ibox float-e-margins">
                        <div class="ibox-content">
                            <ul class="okr-calc" id="J_calc">
                                <li>
                                    <span class="calc-clean">C</span>
                                    <span data-value="(" class="calc-bracket calc-left">(</span>
                                    <span data-value=")" class="calc-bracket calc-right disabled">)</span>
                                    <span class="calc-del">Del</span>
                                </li>
                                <li>
                                    <span data-num-val="7" class="calc-num">7</span>
                                    <span data-num-val="8" class="calc-num">8</span>
                                    <span data-num-val="9" class="calc-num">9</span>
                                    <span data-value="/" class="calc-operation disabled">/</span>
                                </li>
                                <li>
                                    <span data-num-val="4" class="calc-num">4</span>
                                    <span data-num-val="5" class="calc-num">5</span>
                                    <span data-num-val="6" class="calc-num">6</span>
                                    <span data-value="*" class="calc-operation disabled">*</span>
                                </li>
                                <li>
                                    <span data-num-val="1" class="calc-num">1</span>
                                    <span data-num-val="2" class="calc-num">2</span>
                                    <span data-num-val="3" class="calc-num">3</span>
                                    <span data-value="-" class="calc-operation disabled">-</span>
                                </li>
                                <li>
                                    <span class="disabled">&nbsp;</span>
                                    <span data-num-val="0" class="calc-num">0</span>
                                    <span data-value="." class="calc-point disabled">.</span>
                                    <span data-value="+" class="calc-operation disabled">+</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="ibox float-e-margins">
                        <div class="ibox-content">
                         <div class="search-box clearfix">
                                <input type="text" class="search-int fl" id="J_searchval" />
                                <input type="button" class="search-btn fl" id="J_searchBtn" value="搜索" />
                            </div>
                            <ul class="com-list">
                                <li class="com-one">
                                    <span>指标名称</span>
                                </li>
                                <div id="J_compositeData">

                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-4 col-sm-offset-2">
            <input class="btn btn-primary J_save" type="button" value="保存内容">
            <a class="btn btn-white J_cancel" href="javascript:parent.closeLayer();">取消</a>
        </div>
    </div>
</div>
<!--container end-->
<!--模版-->
<script type="text/html" id="J_listTpl">
    {{# for (var x in d) { }}
    {{# var pSizeName = ""; if(d[x].particleSize === "-1"){ pSizeName = "周"; } else if(d[x].particleSize === "-2"){ pSizeName = "月"; }  else if(d[x].particleSize === "-3"){ pSizeName = "年"; }  else if(d[x].particleSize === "1440"){ pSizeName = "天"; } else { pSizeName = d[x].particleSize; } }}
       <li class="com-one J_nameone" data-code="{{d[x].quotaCode}}" data-size="{{d[x].particleSize}}" data-name="{{d[x].quotaName}}">
           <span>{{d[x].quotaName}}（{{pSizeName}}）</span>
    </li>
    {{#} }}
</script>
<!--script start-->
<!-- 全局js -->
<script src="${rc.contextPath}/_resources/js/jquery.min.js?v=2.1.4"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/jquery-1.11.1.min.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/bootstrap.min.js?v=3.3.6"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/laytpl.min.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/plugins/layer/layer.min.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/plugins/select2/select2.min.js?v=4.0.3"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/plugins/My97DatePicker/WdatePicker.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/libs/echarts.min.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/js/utils.min.js"></script>
<!--业务js-->
<script src="${rc.contextPath}/_resources/okr/static/js/common.min.js"></script>
<script src="${rc.contextPath}/_resources/okr/static/js/composite.min.js"></script>
<script>
    var fhmb = new OKR.composite();
    fhmb.init({
        listApi: "${rc.contextPath}/admin/okr/quota/getCompositeList.html",
        saveApi: "${rc.contextPath}/admin/okr/quota/saveQuota.html",
    });
</script>
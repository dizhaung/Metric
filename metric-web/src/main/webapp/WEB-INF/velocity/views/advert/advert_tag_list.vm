<link href="${rc.contextPath}/_resources/css/jquery/combo.select.css" rel="stylesheet">
<script src="${rc.contextPath}/_resources/js/jquery.combo.select.js"></script>
<div class="ibox-content">
    <form role="form" class="form-inline">
        <div class="form-group">
            <label>标签名称:</label><input type="text" id="tagName" class="form-control">
            <label>状态:</label>
            <select class="form-control" style="width:130px;height:33px" name="status" id="status">
                <option value="">请选择</option>
                <option value="1">正常</option>
                <option value="0">禁用</option>
            </select>
            <button class="btn btn-white" type="button" onclick="searchList('1')"><i class="glyphicon glyphicon-search"></i>查询</button>
            #if($permissionTool.hasPermission('advert.tag.add'))
            <button class="btn btn-success" type="button" onclick="newAdvertTag()"><i class="glyphicon glyphicon-plus"></i>新增类型</button>
            #end
        </div>
    </form>
</div>
<div class="jqGrid_wrapper ">
        <table id="table_list_1"></table>
        <div id="pager_list_1"></div>
    </div>
</div>
<script>
  function searchList(page){
       $("#table_list_1").jqGrid('setGridParam',{
            url:'listPageTags.html?'+getParams(),
            page:page
       }).trigger("reloadGrid");
   }
    function getParams(){
      var tagName=$("#tagName").val();
      var status=$("#status").val();
      return "tagName="+tagName+"&status="+status;
   }

   $(document).ready(function () {
       $.jgrid.defaults.styleUI = 'Bootstrap';
       $('#table_list_1').jqGrid({
              url:'listPageTags.html',
              datatype: "json",
              autowidth: true,
              height: jqGridHeight,
              viewrecords:true,
              shrinkToFit: true,
              rowNum: 20,
              rowList: [20, 30, 50],
              colNames: ['标签名称','显示标签','预览','排序号','状态','操作'],
              colModel: [
                 {
                    name: 'tagName',
                    width: 10
                 },
                 {
                       name: 'showTagName',
                       width: 10,
                       editable:true
                  },
                  {
                     name: 'opt',
                     width: 10,
                     formatter : function(value, options, rowObject ) {
                      return "<font color='"+rowObject.color+"'>"+rowObject.showTagName+"</font>";
                  }
                  },
                  {
                      name: 'tagIndex',
                      width: 8
                  },

                   {
                            name: 'status',
                            width: 8,
                           formatter:  customFmatter
                    },
                  {
                  name : "tagId",
                  title : false,
                  width:10,
                  formatter : actFormatter
                  }
              ],
              pager: "#pager_list_1"
         });
   });


function customFmatter(cellvalue, options, rowObject){
    var result="";
    if(cellvalue=='1'){
         result='正常';
    }else{
        result='禁用';
    }
    return result;
}

   var actFormatter = function(cellvalue, options, rawObject) {
    var detailHref = '';
    #if($permissionTool.hasPermission('advert.tag.update'))
    detailHref = '<a href="javascript:edit(\''+rawObject.tagId+'\')" class="btn btn-primary "><i class="glyphicon glyphicon-pencil"></i>编辑</a>';
    #end
    return  detailHref;
   };

function edit(advertTagId){
   layer.open({
     type: 2,
     area: ['900px', '400px'],
     fixed: false,
     title: '编辑标签',
     maxmin: true,
     content: 'toEditAdvertTag.html?tagId='+advertTagId
    });
  }
function newAdvertTag(){
   layer.open({
     type: 2,
     area: ['900px', '400px'],
     fixed: false,
     title: '新建标签',
     maxmin: true,
     content: 'newAdvertTag.html'
    });
  }
</script>